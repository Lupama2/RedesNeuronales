\documentclass[aps,prb,twocolumn,superscriptaddress,floatfix,longbibliography]{revtex4-2}

\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{subcaption}
\usepackage{wrapfig} 
\usepackage[export]{adjustbox}

\usepackage{amsmath,amssymb} % math symbols
\usepackage{bm} % bold math font
\usepackage{graphicx} % for figures
\usepackage{comment} % allows block comments
\usepackage{textcomp} % This package is just to give the text quote '
\usepackage{listings} %para agregar código

%\usepackage{ulem} % allows strikeout text, e.g. \sout{text}

\usepackage[spanish]{babel}

\usepackage{enumitem}
\setlist{noitemsep,leftmargin=*,topsep=0pt,parsep=0pt}

\usepackage{xcolor} % \textcolor{red}{text} will be red for notes
\definecolor{lightgray}{gray}{0.6}
\definecolor{medgray}{gray}{0.4}

\usepackage{hyperref}
\hypersetup{
colorlinks=true,
urlcolor= blue,
citecolor=blue,
linkcolor= blue,
bookmarks=true,
bookmarksopen=false,
}

% Code to add paragraph numbers and titles
\newif\ifptitle
\newif\ifpnumber
\newcounter{para}
\newcommand\ptitle[1]{\par\refstepcounter{para}
{\ifpnumber{\noindent\textcolor{lightgray}{\textbf{\thepara}}\indent}\fi}
{\ifptitle{\textbf{[{#1}]}}\fi}}
%\ptitletrue  % comment this line to hide paragraph titles
%\pnumbertrue  % comment this line to hide paragraph numbers

% minimum font size for figures
\newcommand{\minfont}{6}

% Uncomment this line if you prefer your vectors to appear as bold letters.
% By default they will appear with arrows over them.
% \renewcommand{\vec}[1]{\bm{#1}}

%Cambiar Cuadros por Tablas y lista de...
%\renewcommand{\listtablename}{Índice de tablas}
\renewcommand{\tablename}{Tabla}
\renewcommand{\date}{Fecha}

% \graphicspath{ {C:/Users/lupam/Mi unidad/Pablo Chehade/Instituto Balseiro (IB)/Laboratorio Avanzado/Informe/V5/Figures} } %Para importar imagenes desde una carpeta


\lstset{
  basicstyle=\ttfamily\small,
  breaklines=true,
  frame=single,
  numbers=left,
  numberstyle=\tiny,
  keywordstyle=\color{blue},
  commentstyle=\color{green},
  stringstyle=\color{red},
} %Configuración para el bloque de código


\usepackage[bottom]{footmisc} %para que las notas al pie aparezcan en la misma página



\begin{comment}

%Comandos de interes:

* Para ordenar el documento:
\section{Introducción}
\section{\label{sec:Formatting}Formatting} %label para luego hacer referencia a esa sección

\ptitle{Start writing while you experiment} %pone nombre y título al documento dependiendo de si en el header están los comandos \ptitletrue y \pnumbertrue

* Ecuaciones:
\begin{equation}
a^2+b^2=c^2 \,.
\label{eqn:Pythagoras}
\end{equation}

* Conjunto de ecuaciones:
\begin{eqnarray}
\label{eqn:diagonal}
\nonumber d & = & \sqrt{a^2 + b^2 + c^2} \\
& = & \sqrt{3^2+4^2+12^2} = 13
\end{eqnarray}

* Para hacer items / enumerar:
\begin{enumerate}
  \item
\end{enumerate}

\begin{itemize}
  \item
\end{itemize}

* Figuras:
\begin{figure}[h]
    \includegraphics[clip=true,width=\columnwidth]{pixel-compare}
    \caption{}
     \label{fig:pixels}
\end{figure}

* Conjunto de figuras:
(no recuerdo)


* Para hacer referencias a fórmulas, tablas, secciones, ... dentro del documento:
\ref{tab:spacing}

* Para citar
Elementos de .bib
\cite{WhitesidesAdvMat2004}
url
\url{http://www.mendeley.com/}\\

* Agradecimientos:
\begin{acknowledgments}
We acknowledge advice from Jessie Zhang and Harry Pirie to produce Fig.\ \ref{fig:pixels}.
\end{acknowledgments}

* Apéndice:
\appendix
\section{\label{app:Mendeley}Mendeley}

* Bibliografía:
\bibliography{Hoffman-example-paper}

\end{comment}



\begin{document}

% Allows to rewrite the same title in the supplement
\newcommand{\mytitle}{Estadística de trenes de spikes}

\title{\mytitle}

\author{Pablo Chehade \\
    \small \textit{pablo.chehade@ib.edu.ar} \\
    \small \textit{Redes Neuronales, Instituto Balseiro, CNEA-UNCuyo, Bariloche, Argentina, 2023} \\}
    
    
    
\maketitle

En el ámbito de la neurociencia, el estudio de la actividad eléctrica neuronal es esencial para comprender los mecanismos subyacentes al procesamiento de la información en el cerebro. Una herramienta fundamental en este estudio es el análisis estadístico de los spikes o potenciales de acción. En este trabajo, se analizaron datos experimentales obtenidos por Ariel Rokem a través de electrodos intracelulares en un receptor acústico de un saltamontes. Estos datos comprenden la envolvente de una onda sonora presentada al animal y la respuesta neuronal correspondiente en forma de spikes. Se registraron 128 series de datos, cada una correspondiente a la respuesta neuronal ante el mismo estímulo.

\textcolor{red}{En este caso, la tasa de disparo elevada al inicio se atribuye a que los datos comienzan siempre con un spike.}

\section{Distribución de intervalos entre spikes}

\begin{figure}[h]
  \includegraphics[clip=true,width=0.9\columnwidth]{ISI_histogram.png}
  \caption{Aproximación de la distribución de intervalos entre spikes P(ISI) de la neurona.}
   \label{fig:ISI_histogram}
\end{figure}

A partir de los datos de spikes, se determinaron los Inter Spike Interval (ISI). Estos intervalos se definen como la diferencia temporal entre spikes consecutivos. A continuación, se construyó un histograma de estos intervalos que, normalizado, constituye una aproximación a la distribución de intervalos P(ISI) de la neurona, como se muestra en la figura \ref{fig:ISI_histogram}.

La ausencia de valores cercanos a cero refleja el período refractario de la neurona, un intervalo post-spike durante el cual es improbable que se genere otro spike. Para valores elevados de ISI, la distribución muestra un decaimiento que se asemeja a una función exponencial decreciente. En valores intermedios de ISI, se observa un comportamiento atípico con un pico seguido de una meseta de valor aproximadamente constante.

Además, se puede hacer una caracterización cuantitativa de la distribución. La media de la distribución es $\langle \mathrm{ISI} \rangle = 8.496$ ms y la desviación estándar, $\sigma_{\mathrm{ISI}} = 5.663$ ms, resultando en un Coeficiente de Variabilidad $\mathrm{CV} = \langle \mathrm{ISI} \rangle / \sigma_{\mathrm{ISI}} =  0.667$.

\section{Distribución del número de spikes}

\begin{figure}[h]
  \includegraphics[clip=true,width=0.9\columnwidth]{N_histogram.png}
  \caption{Aproximación la distribución del número de spikes P(N) en cada realización.}
   \label{fig:N_histogram}
\end{figure}


Otro modo de caracterizar la variabilidad de la respuesta neuronal es estudiando la variación de la respuesta de la neurona ante el mismo estímulo. Para tal fin se contabilizó el número total de spikes, N, en cada realización y se estimó la probabilidad P(N) de obtener N spikes en una realización dada, mediante un histograma. Los resultados se muestran en la figura \ref{fig:N_histogram}. Se observa que existe una variabilidad en el número de spikes generados en respuesta al mismo estímulo. Cuantitativamente, la media de esta distribución es $\langle \mathrm{N} \rangle = 117$, mientras que la desviación estándar es $\sigma_{\mathrm{N}} = 13.5$. De este modo, el Factor de Fano $\mathrm{F}$ es $\mathrm{F} =  \sigma_\mathrm{N}^2/\langle \mathrm{N} \rangle = 1.6$.

En base a los resultados obtenidos, se puede determinar si el proceso de generación de spikes es del tipo renewal. En estos procesos se cumple la relación $\mathrm{F} = \mathrm{CV}^2$. Sin embargo, en este análisis F es 1.6, mientras que $\mathrm{CV}^2$ es 0.444. Por lo tanto, el proceso no es del tipo renewal. Esta discrepancia es coherente con la naturaleza de las neuronas reales, donde los ISI no son eventos independientes ya que la neurona tiene "memoria" del comportamiento previo.

\section{Tasa de disparo}

\begin{figure}
  \centering
  \begin{subfigure}[b]{0.3\textwidth}
      \centering
      \includegraphics[width=\textwidth]{tasa_de_disparo_2.png}
      \caption{\label{fig:tasa_de_disparo_2}}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.3\textwidth}
      \centering
      \includegraphics[width=\textwidth]{tasa_de_disparo_300.png}
      \caption{\label{fig:tasa_de_disparo_300}}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.3\textwidth}
      \centering
      \includegraphics[width=\textwidth]{tasa_de_disparo_1000.png}
      \caption{\label{fig:tasa_de_disparo_1000}}
  \end{subfigure}
     \caption{Tasa de disparo para un ancho de caja de T = 2, 300, 1000 ms, correspondientes a las figuras \ref{fig:tasa_de_disparo_2}, \ref{fig:tasa_de_disparo_300} y \ref{fig:tasa_de_disparo_1000}, respectivamente.}
     \label{fig:tasa_de_disparo}
\end{figure}


Una herramienta útil para caracterizar la respuesta generada es la tasa de disparo, que se define como el número de spikes por unidad de tiempo. Esta tasa puede determinarse de dos maneras: promediando las señales de respuesta o, alternativamente, promediando el número de spikes en un intervalo temporal, o ''caja'', de ancho \(T\) para cada tiempo.

En este análisis, se eligió la segunda metodología. La tasa de disparo, calculada para diferentes anchos de caja \(T\), se presenta en la figura \ref{fig:tasa_de_disparo}. Se observa que el histograma es es sensible al ancho \(T\) seleccionado. Con un \(T\) pequeño, como se observa en la figura \ref{fig:tasa_de_disparo_2}, la tasa refleja directamente las señales delta de los spikes. A medida que \(T\) se incrementa, la tasa de disparo revela información adicional, como se ve con \(T = 30\) ms en la figura \ref{fig:tasa_de_disparo_300}. Además, se observa un efecto de borde en los extremos temporales: la tasa decae notoriamente. Si \(T\) es excesivamente grande, como en la figura \ref{fig:tasa_de_disparo_1000}, el comportamiento general cambia debido a la pérdida de detalle de la información. Además, los efectos de borde se vuelven más notorios ya que el ancho de la caja se vuelve comparable con la duración total del intervalo de medición.



\section{Relación lineal entre estímulo y respuesta}


%Creo subfigura
\begin{figure}[h]
  \centering
  \begin{subfigure}[b]{0.3\textwidth}
      \centering
      \includegraphics[width=\textwidth]{STA_total.png}
      \caption{\label{fig:STA_total}}
      \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.3\textwidth}
      \centering
      \includegraphics[width=\textwidth]{STA_parcial.png}
      \caption{\label{fig:STA_parcial}}
  \end{subfigure}
     \caption{Spike-Trigger-Average (STA) multiplicado por la constante de normalización $\sigma^2$ en función del tiempo $t$. En la figura \ref{fig:STA_total}, se grafica para todo el intervalo temporal, mientras que en la figura \ref{fig:STA_parcial} se grafica una ampliación para un intervalo menor.}
     \label{fig:STA}
\end{figure}

\begin{figure}[h]
  \includegraphics[clip=true,width=0.9\columnwidth]{r_vs_r_model.png}
  \caption{Respuesta}
   \label{fig:r_vs_r_model}
\end{figure}

Hasta el momento, solo se ha caracterizado la respuesta neuronal. También resulta de gran interés estudiar la relación entre el estímulo presentado y la respuesta generada. Para entender tal relación, se puede considerar una descripción lineal de la respuesta en función del estímulo. Esta relación se puede expresar como:

\[r(t) = r_0 + \int_0^\infty d\tau D(\tau) S(t - \tau)\]
donde \( r_0 \) es una constante y \( D(t) \) es el kernel lineal.

Asumiendo que el valor medio del estímulo $S(t)$ es nulo, se obtiene que $r_0$ es el valor medio de la tasa de disparo, 116 Hz en este caso. Al despreciar el tiempo de autocorrelación del estímulo, el kernel lineal adquiere la forma
\[D(t) = \frac{1}{\sigma^2} \sum_{SPIKE} S(t_{SPIKE} - t).\]
Aquí, \( \sigma \) es una constante de normalización y la sumatoria se realiza sobre todos los spikes de todas las realizaciones. Con estas aproximaciones, el kernel lineal se conoce como Spike-Trigger-Average (STA).

El STA se presenta en función del tiempo en la figura \ref{fig:STA}. En esta figura, se destaca un pico para tiempos cortos alrededor de \( T_0 = 8 \) ms. Este sería el tiempo para el cual la neurona tiene mayor probabilidad de generar un spike tras un estímulo. Para tiempos más largos, el STA decae y muestra variabilidad, lo cual indica que la sensibilidad de la neurona disminuye con el tiempo.

Basándose en el STA, se calculó la respuesta  \( r_{model}(t) \) del modelo lineal. Para calcular la integral, se discretizó el tiempo y se limitó el intervalo de integración entre 0 y \( T_0 \) para evitar la variabilidad en \( D(t) \) para tiempos más largos. Consecuentemente, como se tiene la señal estímulo a partir de $t = 0$, se evaluó la respuesta a partir del tiempo \( t = T_0 \). Aunque sería necesario conocer la constante \( \sigma \) para comparar \( r(t) \) con \( r_{model}(t) \), se puede comparar \( r(t) - r_0 \) con \( r_{model}(t) \) adimensionalizado arbitrariamente por \( 10^9 \). Esta comparación se muestra en la figura \ref{fig:r_vs_r_model} para un rango limitado de tiempo usando una ventana temporal de 100 ms para calcular \( r(t) \). Se puede observar que el modelo captura adecuadamente el comportamiento de la respuesta, incluidos los picos y las depresiones, aunque presenta variabilidad.



\onecolumngrid

\section{Apéndice}

A continuación se desarrolla el código empleado durante este trabajo implementado en Python.

\begin{lstlisting}[language=Python]

import numpy as np


\end{lstlisting}

\bibliography{Chehade_practica_3.bib}

\end{document}





